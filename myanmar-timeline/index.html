<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Myanmar in Crisis — A Chronicle</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ====== RESET & BASE ====== */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --serif:'Source Serif 4','Georgia',serif;
  --display:'Playfair Display','Georgia',serif;
  --sans:'Inter','Helvetica Neue',sans-serif;
  --bg:#faf8f5;
  --bg-alt:#f0ede8;
  --text:#1a1a1a;
  --text-secondary:#4a4a4a;
  --text-muted:#888;
  --accent:#8b0000;
  --accent-light:#c4302b;
  --border:#d4d0c8;
  --border-light:#e8e4dc;
  --gold:#b8860b;
  --card-bg:#ffffff;
  --shadow:0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
  --shadow-hover:0 8px 24px rgba(0,0,0,0.12), 0 4px 8px rgba(0,0,0,0.06);
  --timeline-width:220px;
}
html{scroll-behavior:smooth;font-size:16px}
body{
  font-family:var(--serif);
  background:var(--bg);
  color:var(--text);
  line-height:1.7;
  -webkit-font-smoothing:antialiased;
  overflow-x:hidden;
}
::selection{background:rgba(139,0,0,0.15);color:var(--text)}

/* ====== HEADER / HERO ====== */
.hero{
  position:relative;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:3rem 2rem;
  background:linear-gradient(180deg, #1a1a1a 0%, #2d1f1f 40%, #3d2222 100%);
  color:#f0ede8;
  overflow:hidden;
}
.hero::before{
  content:'';position:absolute;inset:0;
  background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.02'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.hero-content{position:relative;z-index:1;max-width:800px}
.hero-dateline{
  font-family:var(--sans);
  font-size:0.75rem;
  letter-spacing:0.2em;
  text-transform:uppercase;
  color:rgba(255,255,255,0.5);
  margin-bottom:2rem;
}
.hero h1{
  font-family:var(--display);
  font-size:clamp(2.5rem,6vw,4.5rem);
  font-weight:900;
  line-height:1.1;
  margin-bottom:1rem;
  letter-spacing:-0.02em;
}
.hero h1 em{
  font-style:italic;
  color:var(--accent-light);
  display:block;
  font-size:0.7em;
  margin-top:0.3em;
}
.hero-sub{
  font-family:var(--serif);
  font-size:clamp(1rem,2vw,1.3rem);
  color:rgba(255,255,255,0.65);
  max-width:600px;
  margin:0 auto 2.5rem;
  font-weight:300;
  line-height:1.6;
}
.hero-meta{
  font-family:var(--sans);
  font-size:0.7rem;
  color:rgba(255,255,255,0.35);
  letter-spacing:0.15em;
  text-transform:uppercase;
}
.hero-scroll{
  position:absolute;
  bottom:2rem;
  left:50%;
  transform:translateX(-50%);
  z-index:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:0.5rem;
  color:rgba(255,255,255,0.35);
  font-family:var(--sans);
  font-size:0.65rem;
  letter-spacing:0.15em;
  text-transform:uppercase;
  animation:pulse 2s infinite;
}
.hero-scroll::after{
  content:'';width:1px;height:30px;background:rgba(255,255,255,0.2);
}
@keyframes pulse{0%,100%{opacity:0.4}50%{opacity:0.8}}

/* ====== NAVIGATION BAR ====== */
.nav{
  position:sticky;
  top:0;
  z-index:100;
  background:rgba(250,248,245,0.95);
  backdrop-filter:blur(12px);
  border-bottom:1px solid var(--border-light);
  transition:box-shadow 0.3s;
}
.nav.scrolled{box-shadow:0 2px 8px rgba(0,0,0,0.06)}
.nav-inner{
  max-width:1400px;
  margin:0 auto;
  padding:0 2rem;
  display:flex;
  align-items:center;
  gap:1.5rem;
  height:56px;
}
.nav-title{
  font-family:var(--display);
  font-size:0.95rem;
  font-weight:700;
  color:var(--accent);
  white-space:nowrap;
  flex-shrink:0;
}
.nav-divider{width:1px;height:24px;background:var(--border);flex-shrink:0}
.nav-filters{
  display:flex;
  gap:0.4rem;
  overflow-x:auto;
  scrollbar-width:none;
  -ms-overflow-style:none;
  flex:1;
  padding:4px 0;
}
.nav-filters::-webkit-scrollbar{display:none}
.filter-btn{
  font-family:var(--sans);
  font-size:0.7rem;
  font-weight:500;
  padding:5px 12px;
  border:1px solid var(--border);
  border-radius:20px;
  background:transparent;
  color:var(--text-secondary);
  cursor:pointer;
  white-space:nowrap;
  transition:all 0.2s;
  letter-spacing:0.02em;
}
.filter-btn:hover{border-color:var(--accent);color:var(--accent)}
.filter-btn.active{
  background:var(--accent);
  border-color:var(--accent);
  color:#fff;
}
.nav-search{
  position:relative;
  flex-shrink:0;
}
.nav-search input{
  font-family:var(--sans);
  font-size:0.75rem;
  padding:6px 12px 6px 30px;
  border:1px solid var(--border);
  border-radius:20px;
  background:transparent;
  color:var(--text);
  width:180px;
  transition:all 0.2s;
  outline:none;
}
.nav-search input:focus{border-color:var(--accent);width:220px}
.nav-search::before{
  content:'\2315';
  position:absolute;
  left:10px;
  top:50%;
  transform:translateY(-50%);
  font-size:0.85rem;
  color:var(--text-muted);
}

/* ====== STATS BAR ====== */
.stats-bar{
  background:var(--bg-alt);
  border-bottom:1px solid var(--border-light);
  padding:0.6rem 2rem;
}
.stats-inner{
  max-width:1400px;
  margin:0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-family:var(--sans);
  font-size:0.7rem;
  color:var(--text-muted);
}
.stats-count{font-weight:600;color:var(--text-secondary)}

/* ====== MAIN LAYOUT: TIMELINE LEFT + CONTENT RIGHT ====== */
.main-layout{
  max-width:1400px;
  margin:0 auto;
  display:flex;
  position:relative;
  min-height:100vh;
}

/* ====== LEFT TIMELINE RAIL ====== */
.timeline-rail{
  width:var(--timeline-width);
  flex-shrink:0;
  position:relative;
  padding:2rem 0 4rem;
}
.timeline-line{
  position:absolute;
  left:50%;
  top:0;
  bottom:0;
  width:2px;
  background:var(--border);
  transform:translateX(-50%);
}
.timeline-progress{
  position:absolute;
  left:50%;
  top:0;
  width:2px;
  height:0;
  background:var(--accent);
  transform:translateX(-50%);
  transition:height 0.1s linear;
  z-index:1;
}
.timeline-node{
  position:relative;
  z-index:2;
  display:flex;
  align-items:center;
  padding:0.6rem 0;
  cursor:pointer;
  transition:all 0.2s;
}
.timeline-node .node-dot{
  width:12px;
  height:12px;
  border-radius:50%;
  border:2px solid var(--border);
  background:var(--bg);
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  transition:all 0.3s;
  z-index:2;
}
.timeline-node:hover .node-dot{
  border-color:var(--accent);
  transform:translateX(-50%) scale(1.3);
}
.timeline-node.active .node-dot{
  background:var(--accent);
  border-color:var(--accent);
  transform:translateX(-50%) scale(1.2);
  box-shadow:0 0 0 4px rgba(139,0,0,0.15);
}
.timeline-node .node-label{
  font-family:var(--sans);
  font-size:0.65rem;
  color:var(--text-muted);
  white-space:nowrap;
  position:absolute;
  right:calc(50% + 16px);
  text-align:right;
  transition:color 0.2s;
  letter-spacing:0.02em;
}
.timeline-node.active .node-label{
  color:var(--accent);
  font-weight:600;
}
.timeline-node.year-node .node-dot{
  width:16px;
  height:16px;
  border-width:3px;
}
.timeline-node.year-node .node-label{
  font-size:0.85rem;
  font-weight:700;
  font-family:var(--display);
  color:var(--text);
}
.timeline-node.coup-node .node-dot{
  width:18px;
  height:18px;
  background:var(--accent);
  border-color:var(--accent);
  box-shadow:0 0 0 4px rgba(139,0,0,0.2);
}
.timeline-node.coup-node .node-label{
  color:var(--accent);
  font-weight:700;
  font-size:0.7rem;
}

/* Timeline sticky behavior */
.timeline-rail-sticky{
  position:sticky;
  top:70px;
  height:calc(100vh - 80px);
  overflow-y:auto;
  scrollbar-width:none;
  -ms-overflow-style:none;
  padding:1rem 0;
}
.timeline-rail-sticky::-webkit-scrollbar{display:none}

/* ====== CONTENT AREA ====== */
.content-area{
  flex:1;
  padding:2rem 2rem 4rem 3rem;
  min-width:0;
}

/* ====== BACKGROUND CONTEXT SECTION ====== */
.background-section{
  margin-bottom:3rem;
  padding-bottom:2rem;
  border-bottom:2px solid var(--border);
}
.background-section .section-label{
  font-family:var(--sans);
  font-size:0.65rem;
  font-weight:600;
  text-transform:uppercase;
  letter-spacing:0.2em;
  color:var(--text-muted);
  margin-bottom:0.5rem;
}
.background-section .section-title{
  font-family:var(--display);
  font-size:1.6rem;
  font-weight:700;
  margin-bottom:0.5rem;
}
.background-section .section-desc{
  font-family:var(--serif);
  font-size:0.9rem;
  color:var(--text-secondary);
  max-width:600px;
  line-height:1.6;
  margin-bottom:1.5rem;
}

/* ====== COUP DIVIDER ====== */
.coup-divider{
  margin:3rem 0;
  text-align:center;
  position:relative;
}
.coup-divider::before{
  content:'';
  position:absolute;
  left:0;right:0;
  top:50%;
  height:3px;
  background:var(--accent);
}
.coup-divider-inner{
  position:relative;
  display:inline-block;
  background:var(--bg);
  padding:1.5rem 3rem;
}
.coup-divider .coup-date{
  font-family:var(--sans);
  font-size:0.65rem;
  letter-spacing:0.25em;
  text-transform:uppercase;
  color:var(--accent);
  margin-bottom:0.5rem;
  font-weight:600;
}
.coup-divider h2{
  font-family:var(--display);
  font-size:1.8rem;
  font-weight:900;
  color:var(--accent);
  margin-bottom:0.4rem;
}
.coup-divider p{
  font-family:var(--serif);
  font-size:0.85rem;
  color:var(--text-secondary);
  max-width:460px;
  margin:0 auto;
  line-height:1.5;
}

/* ====== YEAR MARKER ====== */
.year-marker{
  padding:3rem 0 1rem;
}
.year-marker h2{
  font-family:var(--display);
  font-size:3rem;
  font-weight:900;
  color:var(--text);
  opacity:0.1;
  letter-spacing:-0.03em;
}
.year-marker .year-label{
  font-family:var(--sans);
  font-size:0.6rem;
  text-transform:uppercase;
  letter-spacing:0.2em;
  color:var(--text-muted);
  margin-top:0.2rem;
}

/* ====== MONTH HEADER ====== */
.month-section{
  margin-bottom:2.5rem;
  scroll-margin-top:80px;
}
.month-header{
  display:flex;
  align-items:baseline;
  gap:1rem;
  padding-bottom:0.6rem;
  border-bottom:2px solid var(--text);
  margin-bottom:1.25rem;
}
.month-header h3{
  font-family:var(--display);
  font-size:1.35rem;
  font-weight:700;
}
.month-header .issue-num{
  font-family:var(--sans);
  font-size:0.6rem;
  color:var(--text-muted);
  text-transform:uppercase;
  letter-spacing:0.1em;
}

/* ====== ARTICLE CARD — PHOTO BACKGROUND ====== */
.articles-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:1rem;
}

.article-card{
  position:relative;
  border-radius:6px;
  overflow:hidden;
  cursor:pointer;
  min-height:180px;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  transition:all 0.35s ease;
  background-size:cover;
  background-position:center;
  background-color:#2a2a2a;
}
.article-card::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(
    0deg,
    rgba(0,0,0,0.85) 0%,
    rgba(0,0,0,0.5) 40%,
    rgba(0,0,0,0.15) 70%,
    rgba(0,0,0,0.05) 100%
  );
  transition:all 0.35s;
  z-index:1;
}
.article-card:hover::before{
  background:linear-gradient(
    0deg,
    rgba(0,0,0,0.9) 0%,
    rgba(0,0,0,0.6) 50%,
    rgba(0,0,0,0.3) 100%
  );
}
.article-card:hover{
  transform:translateY(-3px);
  box-shadow:var(--shadow-hover);
}

.card-content{
  position:relative;
  z-index:2;
  padding:1.25rem 1.5rem;
  color:#fff;
}
.card-type{
  font-family:var(--sans);
  font-size:0.55rem;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:0.15em;
  color:rgba(255,255,255,0.7);
  margin-bottom:0.35rem;
  display:flex;
  align-items:center;
  gap:0.4rem;
}
.card-type .type-dot{
  width:4px;height:4px;
  border-radius:50%;
  background:var(--accent-light);
  display:inline-block;
}
.card-title{
  font-family:var(--serif);
  font-size:0.95rem;
  font-weight:600;
  line-height:1.45;
  color:#fff;
  margin-bottom:0.6rem;
  text-shadow:0 1px 3px rgba(0,0,0,0.3);
}
.card-tags{
  display:flex;
  flex-wrap:wrap;
  gap:0.3rem;
}
.tag{
  font-family:var(--sans);
  font-size:0.5rem;
  font-weight:600;
  padding:2px 8px;
  border-radius:2px;
  text-transform:uppercase;
  letter-spacing:0.06em;
  background:rgba(255,255,255,0.15);
  color:rgba(255,255,255,0.85);
  backdrop-filter:blur(4px);
}
.card-people{
  display:flex;
  flex-wrap:wrap;
  gap:0.25rem;
  margin-top:0.35rem;
}
.person-pill{
  font-family:var(--sans);
  font-size:0.5rem;
  font-weight:500;
  padding:1px 6px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.25);
  color:rgba(255,255,255,0.7);
  letter-spacing:0.02em;
}

/* Highlight card: spans full width, taller */
.article-card.highlight{
  grid-column:1/-1;
  min-height:260px;
}
.article-card.highlight .card-title{
  font-size:1.2rem;
  font-weight:700;
}
.article-card.highlight .card-type{
  color:var(--accent-light);
}

/* Background (pre-coup) cards get a sepia/desaturated treatment */
.article-card.background-card{
  filter:saturate(0.5) brightness(0.9);
  min-height:140px;
}
.article-card.background-card:hover{
  filter:saturate(0.8) brightness(1);
}

/* ====== THEMED TAG COLORS ON CARDS ====== */
/* On photo cards, tags use subtle glass-like pills */
.tag-coup{background:rgba(139,0,0,0.6);color:#fff}
.tag-sanctions{background:rgba(26,58,139,0.5);color:#fff}
.tag-economy{background:rgba(26,107,26,0.5);color:#fff}
.tag-human_rights{background:rgba(139,26,74,0.5);color:#fff}
.tag-china{background:rgba(184,98,11,0.5);color:#fff}
.tag-resistance{background:rgba(58,58,139,0.5);color:#fff}
.tag-ethnic_conflict{background:rgba(122,90,11,0.5);color:#fff}
.tag-energy{background:rgba(11,106,122,0.5);color:#fff}
.tag-international{background:rgba(74,74,107,0.5);color:#fff}
.tag-aung_san_suu_kyi{background:rgba(139,26,74,0.5);color:#fff}

/* ====== MODAL ====== */
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  z-index:200;
  display:none;
  justify-content:center;
  align-items:center;
  padding:2rem;
  opacity:0;
  transition:opacity 0.3s;
  backdrop-filter:blur(4px);
}
.modal-overlay.show{display:flex;opacity:1}
.modal{
  background:var(--card-bg);
  border-radius:6px;
  max-width:640px;
  width:100%;
  max-height:80vh;
  overflow-y:auto;
  position:relative;
  box-shadow:0 20px 60px rgba(0,0,0,0.3);
}
.modal-hero{
  width:100%;
  height:200px;
  background-size:cover;
  background-position:center;
  position:relative;
}
.modal-hero::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(0deg, var(--card-bg) 0%, rgba(255,255,255,0.3) 60%, transparent 100%);
}
.modal-body-content{
  padding:0 2.5rem 2.5rem;
  margin-top:-1.5rem;
  position:relative;
  z-index:1;
}
.modal-close{
  position:absolute;
  top:0.75rem;
  right:0.75rem;
  background:rgba(0,0,0,0.4);
  border:none;
  font-size:1.2rem;
  cursor:pointer;
  color:#fff;
  line-height:1;
  padding:6px 10px;
  border-radius:4px;
  z-index:10;
  transition:background 0.2s;
}
.modal-close:hover{background:rgba(0,0,0,0.7)}
.modal-type{
  font-family:var(--sans);
  font-size:0.65rem;
  font-weight:600;
  text-transform:uppercase;
  letter-spacing:0.15em;
  color:var(--accent);
  margin-bottom:0.5rem;
}
.modal-date{
  font-family:var(--sans);
  font-size:0.7rem;
  color:var(--text-muted);
  margin-bottom:0.75rem;
}
.modal-title{
  font-family:var(--display);
  font-size:1.5rem;
  font-weight:700;
  line-height:1.3;
  margin-bottom:1.25rem;
  color:var(--text);
}
.modal-tags{
  display:flex;
  flex-wrap:wrap;
  gap:0.4rem;
  margin-bottom:0.5rem;
}
.modal-tags .tag{
  background:var(--bg-alt);
  color:var(--text-secondary);
}
.modal-people{
  display:flex;
  flex-wrap:wrap;
  gap:0.4rem;
  margin-bottom:1.5rem;
}
.modal-people .person-pill{
  border-color:var(--border);
  color:var(--text-muted);
}
.modal-text{
  font-family:var(--serif);
  font-size:0.95rem;
  line-height:1.8;
  color:var(--text-secondary);
  border-top:1px solid var(--border-light);
  padding-top:1.25rem;
}
.modal-text p{margin-bottom:0.75rem}
.modal-context{
  font-family:var(--sans);
  font-size:0.75rem;
  color:var(--text-muted);
  background:var(--bg-alt);
  padding:1rem;
  border-radius:4px;
  margin-top:1rem;
}

/* ====== BACK TO TOP ====== */
.back-top{
  position:fixed;
  bottom:2rem;
  right:2rem;
  z-index:50;
  background:var(--accent);
  color:#fff;
  border:none;
  width:40px;
  height:40px;
  border-radius:50%;
  cursor:pointer;
  font-size:1.1rem;
  display:none;
  align-items:center;
  justify-content:center;
  box-shadow:0 2px 8px rgba(139,0,0,0.3);
  transition:all 0.2s;
}
.back-top.show{display:flex}
.back-top:hover{transform:scale(1.1)}

/* ====== NO RESULTS ====== */
.no-results{
  text-align:center;
  padding:4rem 2rem;
  font-family:var(--sans);
  color:var(--text-muted);
}
.no-results h3{font-size:1.1rem;margin-bottom:0.5rem;color:var(--text-secondary)}
.no-results p{font-size:0.85rem}

/* ====== FOOTER ====== */
.footer{
  text-align:center;
  padding:3rem 2rem;
  border-top:1px solid var(--border-light);
  font-family:var(--sans);
  font-size:0.7rem;
  color:var(--text-muted);
  background:var(--bg-alt);
}
.footer a{color:var(--accent);text-decoration:none}
.footer a:hover{text-decoration:underline}

/* ====== LOADING ====== */
.loading{
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:50vh;
  font-family:var(--sans);
  color:var(--text-muted);
  font-size:0.85rem;
}
.loading::before{
  content:'';
  width:20px;height:20px;
  border:2px solid var(--border);
  border-top-color:var(--accent);
  border-radius:50%;
  animation:spin 0.8s linear infinite;
  margin-right:0.75rem;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* ====== RESPONSIVE ====== */
@media(max-width:1100px){
  :root{--timeline-width:180px}
  .timeline-node .node-label{font-size:0.6rem}
}
@media(max-width:900px){
  .main-layout{flex-direction:column}
  .timeline-rail{display:none}
  .content-area{padding:1.5rem}
  .nav-inner{gap:0.75rem}
  .nav-search input{width:120px}
  .nav-search input:focus{width:160px}
}
@media(max-width:768px){
  .articles-grid{grid-template-columns:1fr}
  .article-card.highlight{min-height:200px}
}
@media(max-width:600px){
  .nav-title{font-size:0.8rem}
  .nav-divider{display:none}
  .hero h1{font-size:2.2rem}
  .month-header h3{font-size:1.2rem}
  .modal-body-content{padding:0 1.5rem 1.5rem}
  .modal-title{font-size:1.2rem}
  .coup-divider h2{font-size:1.3rem}
  .coup-divider-inner{padding:1rem 1.5rem}
}

/* ====== ANIMATION UTILITY ====== */
.fade-in{
  opacity:0;
  transform:translateY(20px);
  transition:opacity 0.5s ease, transform 0.5s ease;
}
.fade-in.visible{
  opacity:1;
  transform:translateY(0);
}
</style>
</head>
<body>

<!-- HERO -->
<section class="hero" id="top">
  <div class="hero-content">
    <p class="hero-dateline">A documentary timeline &middot; 2021&ndash;2026</p>
    <h1>Myanmar in Crisis<em>A Chronicle of Upheaval</em></h1>
    <p class="hero-sub">From the military coup of February 2021 through years of resistance and repression &mdash; tracing Myanmar's political and economic upheaval through primary reporting.</p>
    <p class="hero-meta">Based on the MBRI Newsletter Archive</p>
  </div>
  <div class="hero-scroll">Scroll<br></div>
</section>

<!-- STICKY NAV -->
<nav class="nav" id="nav">
  <div class="nav-inner">
    <div class="nav-title">Myanmar Chronicle</div>
    <div class="nav-divider"></div>
    <div class="nav-filters" id="filters">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="coup">Coup &amp; Military</button>
      <button class="filter-btn" data-filter="sanctions">Sanctions</button>
      <button class="filter-btn" data-filter="resistance">Resistance</button>
      <button class="filter-btn" data-filter="human_rights">Human Rights</button>
      <button class="filter-btn" data-filter="china">China</button>
      <button class="filter-btn" data-filter="international">International</button>
      <button class="filter-btn" data-filter="ethnic_conflict">Ethnic Conflict</button>
      <button class="filter-btn" data-filter="economy">Economy</button>
      <button class="filter-btn" data-filter="energy">Energy</button>
      <button class="filter-btn" data-filter="aung_san_suu_kyi">Aung San Suu Kyi</button>
    </div>
    <div class="nav-search">
      <input type="text" id="searchInput" placeholder="Search articles...">
    </div>
  </div>
</nav>

<!-- STATS BAR -->
<div class="stats-bar">
  <div class="stats-inner">
    <span>Showing <span class="stats-count" id="articleCount">&mdash;</span> articles</span>
    <span id="dateRange"></span>
  </div>
</div>

<!-- MAIN LAYOUT -->
<div class="main-layout" id="mainLayout">

  <!-- LEFT TIMELINE RAIL -->
  <aside class="timeline-rail" id="timelineRail">
    <div class="timeline-line"></div>
    <div class="timeline-progress" id="timelineProgress"></div>
    <div class="timeline-rail-sticky" id="timelineSticky">
      <!-- Populated by JS -->
    </div>
  </aside>

  <!-- CONTENT AREA -->
  <main class="content-area" id="timeline">
    <div class="loading" id="loading">Loading timeline data...</div>
  </main>

</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal" id="modal">
    <button class="modal-close" id="modalClose">&times;</button>
    <div class="modal-hero" id="modalHero"></div>
    <div class="modal-body-content">
      <div class="modal-type" id="modalType"></div>
      <div class="modal-date" id="modalDate"></div>
      <h2 class="modal-title" id="modalTitle"></h2>
      <div class="modal-tags" id="modalTags"></div>
      <div class="modal-people" id="modalPeople"></div>
      <div class="modal-text" id="modalText"></div>
    </div>
  </div>
</div>

<!-- BACK TO TOP -->
<button class="back-top" id="backTop" title="Back to top">&uarr;</button>

<!-- FOOTER -->
<footer class="footer">
  <p>Data sourced from the MBRI Newsletter Archive (2016&ndash;2026). Focused on Feb 2021 onward.</p>
  <p style="margin-top:0.5rem">Built by <a href="https://gyubeanie.github.io" target="_blank">gyubeanie</a></p>
</footer>

<script>
/* ================================================================
   MYANMAR TIMELINE v2 — Interactive Chronicle
   Photo cards, left timeline rail, MBRI archive
   ================================================================ */

// ==================== CONSTANTS ====================

const TAG_LABELS = {
  coup: 'Coup & Military',
  sanctions: 'Sanctions',
  economy: 'Economy',
  human_rights: 'Human Rights',
  china: 'China',
  resistance: 'Resistance',
  ethnic_conflict: 'Ethnic Conflict',
  energy: 'Energy',
  international: 'International',
  aung_san_suu_kyi: 'Aung San Suu Kyi'
};

const MONTH_NAMES = {
  '01':'January','02':'February','03':'March','04':'April',
  '05':'May','06':'June','07':'July','08':'August',
  '09':'September','10':'October','11':'November','12':'December'
};

// Curated Myanmar photos mapped to article themes
const THEME_PHOTOS = {
  coup: [
    'https://images.unsplash.com/photo-1620730752350-eb31be82a90c?w=800&q=80',
    'https://images.unsplash.com/photo-1635426818233-6cfe593eb3f1?w=800&q=80'
  ],
  economy: [
    'https://images.unsplash.com/photo-1699586751277-bb1d47179194?w=800&q=80',
    'https://images.unsplash.com/photo-1644810495465-04a89151ee07?w=800&q=80'
  ],
  china: [
    'https://images.unsplash.com/photo-1601822499690-afba3e54a5a4?w=800&q=80',
    'https://images.unsplash.com/photo-1683568983870-ce2e4506fcb1?w=800&q=80'
  ],
  ethnic_conflict: [
    'https://images.unsplash.com/photo-1576863555995-5cad6274b5f3?w=800&q=80',
    'https://images.unsplash.com/photo-1553419462-a2e3c6d55a0f?w=800&q=80'
  ],
  resistance: [
    'https://images.unsplash.com/photo-1616992249318-0bd168733128?w=800&q=80',
    'https://images.unsplash.com/photo-1635426522203-b888eb102b1e?w=800&q=80'
  ],
  sanctions: [
    'https://images.unsplash.com/photo-1679589164488-ca6dc6746af9?w=800&q=80'
  ],
  energy: [
    'https://images.unsplash.com/photo-1753978304732-35020ea9dfc6?w=800&q=80',
    'https://images.unsplash.com/photo-1678984240126-70bcddd7a228?w=800&q=80'
  ],
  international: [
    'https://images.unsplash.com/photo-1679589164488-ca6dc6746af9?w=800&q=80'
  ],
  human_rights: [
    'https://images.unsplash.com/photo-1727698947614-fe284fd1eb7c?w=800&q=80'
  ],
  aung_san_suu_kyi: [
    'https://images.unsplash.com/photo-1612258000416-4954d59f98c9?w=800&q=80',
    'https://images.unsplash.com/photo-1615524340061-17304c23cc6d?w=800&q=80'
  ],
  general: [
    'https://images.unsplash.com/photo-1559241660-e208651464d9?w=800&q=80',
    'https://images.unsplash.com/photo-1655709307894-1fdbdbe2b373?w=800&q=80',
    'https://images.unsplash.com/photo-1499123785106-343e69e68db1?w=800&q=80',
    'https://images.unsplash.com/photo-1586359024637-e5bc5c8db4a3?w=800&q=80'
  ]
};

function getPhotoForArticle(article) {
  // Use primary tag to pick theme photo
  const primaryTag = (article.tags && article.tags.length > 0) ? article.tags[0] : 'general';
  const photos = THEME_PHOTOS[primaryTag] || THEME_PHOTOS.general;
  // Use article id hash to pick consistently
  const hash = article.id.split('').reduce((a, c) => a + c.charCodeAt(0), 0);
  return photos[hash % photos.length];
}

const YEAR_LABELS = {
  '2016': 'Pre-Coup Era',
  '2017': 'Rohingya Crisis',
  '2018': 'Democratic Tensions',
  '2019': 'Fragile Democracy',
  '2020': 'Election Year',
  '2021': 'The Year of the Coup',
  '2022': 'Under Military Rule',
  '2023': 'Deepening Crisis',
  '2024': 'Resistance & Conflict',
  '2025': 'Ongoing Struggle',
  '2026': 'No End in Sight'
};

let allData = null;
let currentFilter = 'all';
let searchQuery = '';

// ==================== LOAD DATA ====================
async function loadData() {
  try {
    const res = await fetch('data.json');
    allData = await res.json();
    document.getElementById('loading').remove();
    render();
    initScrollObserver();
  } catch (e) {
    document.getElementById('loading').innerHTML =
      '<div style="text-align:center"><h3 style="font-size:1rem;margin-bottom:0.5rem">Unable to load data</h3><p style="font-size:0.8rem;color:#888">Make sure data.json is in the same directory.</p></div>';
    console.error(e);
  }
}

// ==================== RENDER ====================
function render() {
  const timeline = document.getElementById('timeline');
  const issues = filterIssues();

  let totalArticles = 0;
  let html = '';
  let lastYear = '';
  let coupDividerShown = false;
  let timelineNodes = [];
  let backgroundIssues = [];
  let postCoupStarted = false;

  // Separate background vs post-coup
  issues.forEach(issue => {
    if (issue.isBackground) {
      backgroundIssues.push(issue);
    }
  });

  // Render background section first if there are pre-coup highlights
  if (backgroundIssues.length > 0 && currentFilter === 'all' && !searchQuery) {
    html += `<div class="background-section">
      <div class="section-label">Background</div>
      <div class="section-title">Before the Coup</div>
      <div class="section-desc">Key events from Myanmar's democratic transition era that set the stage for the military takeover of February 2021.</div>
      <div class="articles-grid">`;

    backgroundIssues.forEach(issue => {
      const articles = filterArticles(issue.articles);
      articles.forEach(a => {
        totalArticles++;
        html += renderCard(a, issue, true);
      });
    });

    html += `</div></div>`;
  }

  // Render post-coup content
  issues.forEach(issue => {
    if (issue.isBackground) return;
    const [year, month] = issue.date.split('-');
    const articles = filterArticles(issue.articles);
    if (articles.length === 0) return;
    totalArticles += articles.length;

    // Year marker
    if (year !== lastYear) {
      lastYear = year;
      const yearLabel = YEAR_LABELS[year] || '';
      html += `<div class="year-marker" id="year-${year}">
        <h2>${year}</h2>
        ${yearLabel ? `<div class="year-label">${yearLabel}</div>` : ''}
      </div>`;
    }

    // Coup divider before Feb 2021
    if (issue.date === '2021-02' && !coupDividerShown) {
      coupDividerShown = true;
      html += `<div class="coup-divider" id="coup-divider">
        <div class="coup-divider-inner">
          <div class="coup-date">February 1, 2021</div>
          <h2>The Military Seizes Power</h2>
          <p>Myanmar's military detains Aung San Suu Kyi and senior government leaders, declaring a one-year state of emergency and ending a decade of fragile democratic governance.</p>
        </div>
      </div>`;
    }

    // Month section
    const monthName = MONTH_NAMES[month] || month;
    timelineNodes.push({ date: issue.date, label: `${monthName} ${year}`, id: `month-${issue.date}`, isCoup: issue.date === '2021-02' });

    html += `<section class="month-section fade-in" id="month-${issue.date}">
      <div class="month-header">
        <h3>${monthName} ${year}</h3>
        <span class="issue-num">Issue No. ${issue.issueNum} &middot; ${articles.length} articles</span>
      </div>
      <div class="articles-grid">`;

    articles.forEach(a => {
      html += renderCard(a, issue, false);
    });

    html += `</div></section>`;
  });

  if (totalArticles === 0) {
    html = `<div class="no-results">
      <h3>No articles found</h3>
      <p>Try adjusting your filter or search query.</p>
    </div>`;
  }

  timeline.innerHTML = html;
  document.getElementById('articleCount').textContent = totalArticles.toLocaleString();

  const dates = issues.filter(i => !i.isBackground).map(i => i.date).sort();
  if (dates.length > 0) {
    const first = formatDateLabel(dates[0]);
    const last = formatDateLabel(dates[dates.length - 1]);
    document.getElementById('dateRange').textContent = `${first} \u2014 ${last}`;
  }

  buildTimeline(timelineNodes);
  initFadeIn();
}

function renderCard(a, issue, isBackground) {
  const isHL = a.isHighlight;
  const photo = getPhotoForArticle(a);
  const typeLabel = a.type === 'analysis' ? (
    a.title.includes('HOT ISSUE') ? 'Hot Issue' :
    a.title.includes('HOT REPORT') || a.title.includes('HOT Report') ? 'Report' :
    a.title.includes('ISSUE ANALYSIS') ? 'Analysis' :
    a.title.includes("EDITOR'S CHOICE") || a.title.includes("EDITOR'S CHOICE") ? "Editor's Choice" :
    'Analysis'
  ) : '';

  const bgClass = isBackground ? ' background-card' : '';
  let cardHtml = `<div class="article-card${isHL ? ' highlight' : ''}${bgClass}" data-id="${a.id}" style="background-image:url('${photo}')" onclick="openModal('${a.id}')">`;
  cardHtml += `<div class="card-content">`;
  if (typeLabel) cardHtml += `<div class="card-type"><span class="type-dot"></span>${typeLabel}</div>`;
  if (isBackground) cardHtml += `<div class="card-type"><span class="type-dot"></span>${formatDateLabel(issue.date)}</div>`;
  cardHtml += `<div class="card-title">${cleanTitle(a.title)}</div>`;

  if (a.tags && a.tags.length > 0) {
    cardHtml += `<div class="card-tags">`;
    a.tags.forEach(t => {
      cardHtml += `<span class="tag tag-${t}">${TAG_LABELS[t] || t}</span>`;
    });
    cardHtml += `</div>`;
  }
  if (a.people && a.people.length > 0) {
    cardHtml += `<div class="card-people">`;
    a.people.forEach(p => {
      cardHtml += `<span class="person-pill">${p}</span>`;
    });
    cardHtml += `</div>`;
  }
  cardHtml += `</div></div>`;
  return cardHtml;
}

function cleanTitle(t) {
  return t.replace(/^\d+\.\s*/, '')
          .replace(/^ISSUE ANALYSIS:\s*/i, '')
          .replace(/^HOT ISSUE\s*\d*:\s*/i, '')
          .replace(/^HOT REPORT\s*\d*:\s*/i, '')
          .replace(/^HOT Report\s*\d*:\s*/i, '')
          .replace(/^EDITOR'S CHOICE:\s*/i, '')
          .replace(/^EDITOR\u2019S CHOICE:\s*/i, '')
          .replace(/^MEMO:\s*/i, '')
          .replace(/&lt;/g, '<').replace(/&gt;/g, '>')
          .replace(/&amp;/g, '&')
          .trim();
}

function formatDateLabel(d) {
  const [y, m] = d.split('-');
  return `${MONTH_NAMES[m] || m} ${y}`;
}

// ==================== FILTER ====================
function filterIssues() {
  if (!allData) return [];
  return allData.issues.filter(issue => {
    const arts = filterArticles(issue.articles);
    return arts.length > 0;
  });
}

function filterArticles(articles) {
  return articles.filter(a => {
    if (currentFilter !== 'all') {
      if (!a.tags || !a.tags.includes(currentFilter)) return false;
    }
    if (searchQuery) {
      const q = searchQuery.toLowerCase();
      const inTitle = a.title.toLowerCase().includes(q);
      const inTags = (a.tags || []).some(t => TAG_LABELS[t]?.toLowerCase().includes(q));
      const inPeople = (a.people || []).some(p => p.toLowerCase().includes(q));
      if (!inTitle && !inTags && !inPeople) return false;
    }
    return true;
  });
}

// ==================== LEFT TIMELINE ====================
function buildTimeline(nodes) {
  const sticky = document.getElementById('timelineSticky');
  if (!sticky) return;

  // Group nodes by year
  let html = '';
  let lastYear = '';

  nodes.forEach(node => {
    const [year] = node.date.split('-');
    if (year !== lastYear) {
      lastYear = year;
      html += `<div class="timeline-node year-node" data-target="year-${year}">
        <span class="node-label">${year}</span>
        <span class="node-dot"></span>
      </div>`;
    }

    const isCoup = node.date === '2021-02';
    html += `<div class="timeline-node${isCoup ? ' coup-node' : ''}" data-target="${node.id}" data-date="${node.date}">
      <span class="node-label">${node.label.split(' ')[0]}</span>
      <span class="node-dot"></span>
    </div>`;
  });

  sticky.innerHTML = html;

  // Click to scroll
  sticky.querySelectorAll('.timeline-node').forEach(node => {
    node.addEventListener('click', () => {
      const target = document.getElementById(node.dataset.target);
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });
}

// ==================== SCROLL OBSERVER ====================
function initScrollObserver() {
  if (!('IntersectionObserver' in window)) return;

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.id;
        // Update timeline active state
        document.querySelectorAll('.timeline-node').forEach(n => n.classList.remove('active'));
        const activeNode = document.querySelector(`.timeline-node[data-target="${id}"]`);
        if (activeNode) {
          activeNode.classList.add('active');
          // Scroll the timeline sidebar to keep active node visible
          activeNode.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
      }
    });
  }, {
    rootMargin: '-20% 0px -70% 0px',
    threshold: 0
  });

  document.querySelectorAll('.month-section, .year-marker').forEach(el => {
    observer.observe(el);
  });
}

// ==================== FADE-IN ANIMATION ====================
function initFadeIn() {
  if (!('IntersectionObserver' in window)) {
    document.querySelectorAll('.fade-in').forEach(el => el.classList.add('visible'));
    return;
  }

  const fadeObs = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        fadeObs.unobserve(entry.target);
      }
    });
  }, { rootMargin: '0px 0px -50px 0px', threshold: 0.1 });

  document.querySelectorAll('.fade-in').forEach(el => fadeObs.observe(el));
}

// ==================== MODAL ====================
function openModal(id) {
  if (!allData) return;
  let article = null, issueDate = '';
  for (const issue of allData.issues) {
    const found = issue.articles.find(a => a.id === id);
    if (found) { article = found; issueDate = issue.date; break; }
  }
  if (!article) return;

  const overlay = document.getElementById('modalOverlay');
  const photo = getPhotoForArticle(article);

  // Hero image
  document.getElementById('modalHero').style.backgroundImage = `url('${photo}')`;

  const typeLabel = article.type === 'analysis' ? 'Analysis / Special Report' : 'News Report';
  document.getElementById('modalType').textContent = typeLabel;
  document.getElementById('modalDate').textContent = formatDateLabel(issueDate);
  document.getElementById('modalTitle').textContent = cleanTitle(article.title);

  let tagsHtml = '';
  (article.tags || []).forEach(t => {
    tagsHtml += `<span class="tag tag-${t}">${TAG_LABELS[t] || t}</span>`;
  });
  document.getElementById('modalTags').innerHTML = tagsHtml;

  let peopleHtml = '';
  (article.people || []).forEach(p => {
    peopleHtml += `<span class="person-pill">${p}</span>`;
  });
  document.getElementById('modalPeople').innerHTML = peopleHtml;

  let bodyHtml = `<p>This article was published in the <strong>${formatDateLabel(issueDate)}</strong> issue of the MBRI Newsletter.</p>`;
  bodyHtml += `<p style="font-size:1.05rem;font-weight:600;color:var(--text);line-height:1.6">\u201C${article.title}\u201D</p>`;
  bodyHtml += `<div class="modal-context">Full article text will be available in a future update. Click on a title in the timeline to preview the article metadata and classification.</div>`;
  document.getElementById('modalText').innerHTML = bodyHtml;

  overlay.classList.add('show');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('show');
  document.body.style.overflow = '';
}

document.getElementById('modalClose').addEventListener('click', closeModal);
document.getElementById('modalOverlay').addEventListener('click', e => {
  if (e.target === e.currentTarget) closeModal();
});
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeModal();
});

// ==================== FILTER BUTTONS ====================
document.getElementById('filters').addEventListener('click', e => {
  const btn = e.target.closest('.filter-btn');
  if (!btn) return;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentFilter = btn.dataset.filter;
  render();
  const firstSection = document.querySelector('.month-section, .background-section');
  if (firstSection) firstSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
});

// ==================== SEARCH ====================
let searchTimeout;
document.getElementById('searchInput').addEventListener('input', e => {
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(() => {
    searchQuery = e.target.value.trim();
    render();
  }, 300);
});

// ==================== NAV SCROLL & BACK-TO-TOP ====================
const nav = document.getElementById('nav');
window.addEventListener('scroll', () => {
  nav.classList.toggle('scrolled', window.scrollY > 100);
  document.getElementById('backTop').classList.toggle('show', window.scrollY > 600);
}, { passive: true });

document.getElementById('backTop').addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// ==================== INIT ====================
loadData();
</script>
</body>
</html>
